"use strict";

var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.generateNonce = exports.checkEnvironment = void 0;

var _nonce = _interopRequireDefault(require("nonce"));

var _logger = _interopRequireDefault(require("./logger"));

var authEnabled = process.env.AUTH_ENABLED === 'true' || process.env.AUTH_REQUIRED === 'true';
/**
 * Ensure that environment variables are set up correctly
 * @return {boolean} Is auth enabled?
 */

var checkEnvironment = function checkEnvironment() {
  if (!authEnabled) {
    _logger["default"].warn('Auth is disabled.');

    _logger["default"].info('Set AUTH_ENABLED to true in your environment variables');
  } else {
    _logger["default"].success('Auth is enabled. Using PING flow.');
  } // check that all environment variables are present


  if (!('OPENID_CLIENT_ID' in process.env)) {
    _logger["default"].error('You appear to be missing OPENID_CLIENT_ID from your environment variables');

    _logger["default"].error('The Ping auth flow will not work without this!');

    _logger["default"].error('Auth has been disabled due to misconfiguration.');

    authEnabled = false;
  }

  return authEnabled;
};
/**
 * Generate a nonce of 15 chars
 * @return {string} nonce
 */


exports.checkEnvironment = checkEnvironment;

var generateNonce = function generateNonce() {
  var len = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 15;
  return "".concat((0, _nonce["default"])(len)());
};

exports.generateNonce = generateNonce;
//# sourceMappingURL=util.js.map

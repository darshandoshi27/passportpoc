"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports["default"] = void 0;

var _default = function _default(options) {
  if (typeof options === 'string') {
    options = {
      redirectTo: options
    };
  }

  options = options || {};
  var url = options.redirectTo || '/login';
  var setReturnTo = options.setReturnTo === undefined ? true : options.setReturnTo;
  return function (req, res, next) {
    if (!req.isAuthenticated || !req.isAuthenticated()) {
      if (setReturnTo && req.session) {
        req.session.returnTo = req.originalUrl || req.url;

        if (req.session.save && typeof req.session.save === 'function') {
          return req.session.save(function () {
            res.redirect(url);
          });
        }
      }

      return res.redirect(url);
    }

    return next();
  };
};

exports["default"] = _default;
//# sourceMappingURL=ensure-login.js.map

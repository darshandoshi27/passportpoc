{"version":3,"sources":["ensure-login.js"],"names":["options","redirectTo","url","setReturnTo","undefined","req","res","next","isAuthenticated","session","returnTo","originalUrl","save","redirect"],"mappings":";;;;;;;eAAe,kBAACA,OAAD,EAAa;AAC1B,MAAI,OAAOA,OAAP,KAAmB,QAAvB,EAAiC;AAC/BA,IAAAA,OAAO,GAAG;AAAEC,MAAAA,UAAU,EAAED;AAAd,KAAV;AACD;;AACDA,EAAAA,OAAO,GAAGA,OAAO,IAAI,EAArB;AAEA,MAAME,GAAG,GAAGF,OAAO,CAACC,UAAR,IAAsB,QAAlC;AACA,MAAME,WAAW,GAAIH,OAAO,CAACG,WAAR,KAAwBC,SAAzB,GAChB,IADgB,GAEhBJ,OAAO,CAACG,WAFZ;AAIA,SAAO,UAACE,GAAD,EAAMC,GAAN,EAAWC,IAAX,EAAoB;AACzB,QAAI,CAACF,GAAG,CAACG,eAAL,IAAwB,CAACH,GAAG,CAACG,eAAJ,EAA7B,EAAoD;AAClD,UAAIL,WAAW,IAAIE,GAAG,CAACI,OAAvB,EAAgC;AAC9BJ,QAAAA,GAAG,CAACI,OAAJ,CAAYC,QAAZ,GAAuBL,GAAG,CAACM,WAAJ,IAAmBN,GAAG,CAACH,GAA9C;;AACA,YAAIG,GAAG,CAACI,OAAJ,CAAYG,IAAZ,IAAoB,OAAOP,GAAG,CAACI,OAAJ,CAAYG,IAAnB,KAA4B,UAApD,EAAgE;AAC9D,iBAAOP,GAAG,CAACI,OAAJ,CAAYG,IAAZ,CAAiB,YAAM;AAC5BN,YAAAA,GAAG,CAACO,QAAJ,CAAaX,GAAb;AACD,WAFM,CAAP;AAGD;AACF;;AACD,aAAOI,GAAG,CAACO,QAAJ,CAAaX,GAAb,CAAP;AACD;;AACD,WAAOK,IAAI,EAAX;AACD,GAbD;AAcD,C","sourcesContent":["export default (options) => {\n  if (typeof options === 'string') {\n    options = { redirectTo: options };\n  }\n  options = options || {};\n\n  const url = options.redirectTo || '/login';\n  const setReturnTo = (options.setReturnTo === undefined)\n    ? true\n    : options.setReturnTo;\n\n  return (req, res, next) => {\n    if (!req.isAuthenticated || !req.isAuthenticated()) {\n      if (setReturnTo && req.session) {\n        req.session.returnTo = req.originalUrl || req.url;\n        if (req.session.save && typeof req.session.save === 'function') {\n          return req.session.save(() => {\n            res.redirect(url);\n          });\n        }\n      }\n      return res.redirect(url);\n    }\n    return next();\n  };\n};\n"],"file":"ensure-login.js"}
# Changelog

All notable changes to this project will be documented in this file.

The format is based on [Keep a Changelog](https://keepachangelog.com/en/1.0.0/), and this project adheres to [Semantic Versioning](https://semver.org/spec/v2.0.0.html).

## [4.0.6] - 2019-03-10
### Changed
- Added logic to check whether claims object have uid, and print uid if it's present.

## [4.0.5] - 2019-03-06
### Changed
- Updated API Gateway scopes in README, per Federation team.

## [4.0.2] - 2019-02-10
### Added
- Added response_mode parameter.

## [4.0.1] - 2019-12-17
### Added
- Added module for JSDoc Support.
- Changed Node Version to LTS. 

## [4.0.0] - 2019-12-10
### Added
- Azure AD support
### Removed
- Explicit PingFederate support, including PING_VERSION
### Changed
- Default OpenID Connect (OIDC) issuer is now Lilly's production Azure AD, using its "v2" endpoints
- The OIDC userinfo endpoint is no longer used.  Azure AD's endpoint doesn't accept access tokens with app scopes; returned values are a subset of ID token's claims anyway.
- To obtain user attributes provided by the ID token, use `req.session.passport.user.claims` instead of `req.session.passport.user.userinfo`
- The user's Lilly system ID (e.g. C123456) is now provided by `req.session.passport.user.claims.uid`
- `req.session.passport.user.sub` and `req.session.passport.user.claims.sub` no longer provide the user's Lilly system ID.  Their value is now an Azure AD-specific identifier representing a combination of app + user identities
- Update all module dependencies to latest

## [3.1.3] - 2019-11-04
### Changed
- Update contact information

## [3.1.2] - 2019-10-10
### Changed
- Updated packages to the latest packages

## [3.1.1] - 2019-07-22
### Fixed
- Change `req.hostname` to `req.get('host')` as Heroku doesn't use the X-Forwarded-Host header

## [3.1.0] - 2019-07-04
### Changed
- Update openid-client package to version 3.2.0

## [3.0.0] - 2019-06-29
### Changed
- Update gulp package to version 4.0.2
- Update openid-client package to version 3.1.1
- Update nock package to 11.0.0-beta.19
- Update gulp default task
- Fixed unit test for /login end point after updating nock package.

## [2.2.3] - 2019-05-09
### Changed
- Change `req.get('host')` to `req.hostname` to respect `X-Forwarded` header behind proxy

## [2.2.2] - 2019-03-13
### Changed
- Update `before_deploy` command for Jenkins

## [2.2.1] - 2019-03-13
### Changed
- Update contribution guide
- Remove `dist` folder
- The project will now be built as part of the Jenkins pipeline

## [2.2.0] - 2019-03-06
### Added
- Userinfo is now available in the `req.session.passport.user.userinfo` object

## [2.1.0] - 2019-02-20
### Changed
- Now correctly forwards protocol from Heroku if present.

## [2.0.2] - 2019-02-20
### Changed
- Remove yarn.lock to fix Snyk failure

## [2.0.1] - 2019-02-08
### Added
- Made all express-session options configurable, documented in README
- Made REFRESH_WINDOW configurable
- Added more unit tests

### Changed
- Fixed a bug with expired JWT not getting expired
- Log user out when JWT cannot be refreshed

## [2.0.0] - 2018-12-19
### Added
- Encrypt session data being stored in Redis using aes-256-cbc encryption
- Unit tests using `nock`, `mocha`, and `chai`
- Start documenting changes in a CHANGELOG.md file

### Changed
- Modify authentication strategy to use `passport` and `openid-client`
- Update README with new maintainer information and .npmrc
- Fixed an issue with environment variables being ignored

[4.0.6]: https://github.com/EliLillyCo/CIRR_OIDC_AUTH_MODULE/compare/v4.0.6...v4.0.5
[4.0.5]: https://github.com/EliLillyCo/CIRR_OIDC_AUTH_MODULE/compare/v4.0.5...v4.0.2
[4.0.2]: https://github.com/EliLillyCo/CIRR_OIDC_AUTH_MODULE/compare/v4.0.2...v4.0.1
[4.0.1]: https://github.com/EliLillyCo/CIRR_OIDC_AUTH_MODULE/compare/v4.0.1...v4.0.0
[4.0.0]: https://github.com/EliLillyCo/CIRR_OIDC_AUTH_MODULE/compare/v3.1.3...v4.0.0
[3.1.3]: https://github.com/EliLillyCo/CIRR_OIDC_AUTH_MODULE/compare/v3.1.2...v3.1.3
[3.1.2]: https://github.com/EliLillyCo/CIRR_OIDC_AUTH_MODULE/compare/v3.1.1...v3.1.2
[3.1.1]: https://github.com/EliLillyCo/CIRR_OIDC_AUTH_MODULE/compare/v3.1.0...v3.1.1
[3.1.0]: https://github.com/EliLillyCo/CIRR_OIDC_AUTH_MODULE/compare/v3.0.0...v3.1.0
[3.0.0]: https://github.com/EliLillyCo/CIRR_OIDC_AUTH_MODULE/compare/v2.2.3...v3.0.0
[2.2.3]: https://github.com/EliLillyCo/CIRR_OIDC_AUTH_MODULE/compare/v2.2.2...v2.2.3
[2.2.2]: https://github.com/EliLillyCo/CIRR_OIDC_AUTH_MODULE/compare/v2.2.1...v2.2.2
[2.2.1]: https://github.com/EliLillyCo/CIRR_OIDC_AUTH_MODULE/compare/v2.2.0...v2.2.1
[2.2.0]: https://github.com/EliLillyCo/CIRR_OIDC_AUTH_MODULE/compare/v2.1.0...v2.2.0
[2.1.0]: https://github.com/EliLillyCo/CIRR_OIDC_AUTH_MODULE/compare/v2.0.2...v2.1.0
[2.0.2]: https://github.com/EliLillyCo/CIRR_OIDC_AUTH_MODULE/compare/v2.0.1...v2.0.2
[2.0.1]: https://github.com/EliLillyCo/CIRR_OIDC_AUTH_MODULE/compare/v2.0.0...v2.0.1
[2.0.0]: https://github.com/EliLillyCo/CIRR_OIDC_AUTH_MODULE/compare/v1.2.1...v2.0.0
